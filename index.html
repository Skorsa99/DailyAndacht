<!DOCTYPE html>
<html lang="de">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XR8059THL2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-XR8059THL2');
    </script>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DailyAndacht</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./elements/Styles.css">
    <link rel="icon" href="./elements/Logo.jpeg">
</head>
    <body>
        <div class="wrapper">
            <div class="firstDiv">
                <div class="firstDivContent">
                    <img class="Logo" src="./elements/Logo.jpeg" alt="Logo" style="aspect-ratio: 1 / 1;">
                    <div class="Announcement">
                        Vielen Dank für Ihren Besuch auf unserer Webseite.<br>Wir möchten Sie darauf hinweisen, dass unsere Seite derzeit noch in Bearbeitung ist. Es kann daher zu gelegentlichen Ausfällen beim Hochladen von Inhalten kommen. Wir entschuldigen uns für eventuelle Unannehmlichkeiten und arbeiten hart daran, die Webseite so schnell wie möglich zu verbessern.<br>Vielen Dank für Ihr Verständnis.
                    </div>
                </div>
            </div>
            <div class="secondDiv">
                <div id="headerdiv" class="Andacht-Header"></div>
                <div id="readtimediv" class="Andacht-Text"></div>
                <div id="textdiv" class="Andacht-Text"></div>
                <div class="Andacht-Trenner"></div>
                <div class="Andacht-Header-Small">
                    Andacht:
                </div>
                <div id="sermondiv" class="Andacht-Text"></div>
                <div class="Andacht-Trenner"></div>
                <div class="Andacht-Header-Small">
                    Gebet:
                </div>
                <div id="prayerdiv" class="Andacht-Text"></div>
                <div class="Andacht-Trenner"></div>
                <div id="datediv" class="Andacht-Text" style="width: 100%; text-align: center;"></div>
                <div style="height: 30px;"></div>
            </div>
            <div class="thirdDiv">
                <button class="Button" onclick="window.open('https://www.buymeacoffee.com/DailyAndacht', '_blank');">
                    Support us
                </button>                  
            </div>
        </div>
        <script>
            // Get the date from local storage, or use the current date as a fallback
            const selectedDate = localStorage.getItem('selectedDate') || (function() {
                const currentDate = new Date();
                const day = String(currentDate.getDate()).padStart(2, '0');
                const month = String(currentDate.getMonth() + 1).padStart(2, '0');
                const year = currentDate.getFullYear();
                return `${year}${month}${day}`;
            })();
        
            const url = `./andachten/${selectedDate}.csv`;
            
            fetch(url)
                .then(response => response.text())
                .then(data => {
                    // Split the CSV data into an array of rows
                    const values = data.split('*DailyAndachtSeperationTag*');
            
                    // Display the data in the appropriate divs
                    document.getElementById('headerdiv').innerHTML = values[0];
                    document.getElementById('readtimediv').innerHTML = "Lese-Dauer: " + values[1] + " Minuten";
                    document.getElementById('textdiv').innerHTML = "Text: " + values[2];
                    document.getElementById('sermondiv').innerHTML = values[3];
                    document.getElementById('prayerdiv').innerHTML = values[4];
                    document.getElementById('datediv').innerHTML = values[5];
                    // document.getElementById('authordiv').innerHTML = values[6];
                })
                .catch(error => console.error(error));
        
            // Clear the selected date from local storage when the user leaves the page
            window.addEventListener('beforeunload', () => {
                localStorage.removeItem('selectedDate');
            });
        </script>
    </body>
</html>
